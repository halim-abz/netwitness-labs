# Application Rules (App Rules) ðŸ“

This directory contains custom **Application Rules** (App Rules) for NetWitness Decoders.

## ðŸ“– What are App Rules?
Application Rules are lightweight enrichment and detection logics that sit on the Decoder (Logs or Network). They generate new **Metadata** based on specific criteria and logics within a single session or log.

---

## ðŸ“¥ How to Import App Rules (.nwr)

Since these are "Labs" rules, they are not available in NetWitness Live. You must import them manually into your Decoder.

### Prerequisites
* You must have **Administrator** access to the NetWitness UI.
* You need the `.nwr` file downloaded from this directory.

### Step-by-Step Import Guide

1.  **Download** the `.nwr` file from this repository to your local machine.
2.  Log in to the **NetWitness Platform**.
3.  Navigate to **Config** > **Policies**.
4.  Under **Content Library** select the **Application Rule** tab.
5.  Click on **Import**.
6.  Browse and select your `.nwr` file.
7.  **Important:** Once imported, the rule is not active, it must be added to a policy and get deployed.

---

## ðŸ“‚ Contents

| Type | Data | Description |
| :--- | :--- | :--- |
| **[`large subdomain`](large_subdomain.nwr/)** | Logs, Network | Identifies long subdomains that have more than 30 characters. Attackers can exfiltrate data, send/receive commands â€¦ via the subdomain. Each subdomain can have a maximum of 63 characters with a total maximum record size of 253 characters. |
| **[`six or more subdomains`](six_or_more_subdomains.nwr/)** | Logs, Network | Identifies alias.host with 6 or more subdomains. Attackers can exfiltrate data, send/receive commands â€¦ via the subdomain. Each subdomain can have a maximum of 63 characters with a total maximum record size of 253 characters. |
| **[`mixed upper and lower case domain for outbound traffic`](mixed_upper_lower_case_domain_outbound.nwr/)** | Logs, Network | It is not usual for a user to input a domain name by mixing lower and upper case characters (with the exception of the first letter due to auto correct in some cases). In addition, newer browsers automatically convert the URL to lowercase and seeing mixed case therefore means the query was not generated by a browser. |
| **[`non-alphanumerical domain`](non_alphanumerical_domain.nwr/)** | Logs, Network | Identifies domains with non-alphanumerical characters. A domain name with non alpha numerical characters can be indicative of a malicious domain, such as building a domain name that looks like a known legitimate website by using visually similar characters. This can lead to false positive in countries that use different alphabets. |
| **[`filename with multiple spaces`](filename_multiple_spaces.nwr/)** | Logs, Network | Identifies filenames that have multiple spaces. Adding white spaces to a filename might be used to artificially make it longer and hide some parts of the filename. |
| **[`plaintext password for critical account`](plaintext_password_critical_account.nwr/)** | Network | Identifies critical accounts with plaintext passwords. |
| **[`rdp with sensitive account`](rdp_with_sensitive_account.nwr/)** | Network | Identifies logins over RDP using a sensitive account. |
| **[`potential password file`](potential_password_file.nwr/)** | Network | Identifies filenames that may be indicative of storing passwords. Users might store passwords in files on their machines instead of using password managers. If an attacker gets hold of such files he may gain access to those passwords. Often users name those file with obvious names. |
| **[`hacktool user agent`](hacktool_user_agent.nwr/)** | Logs, Network | Identifies default user-agent strings used by common hacking tools. |
| **[`suspicious user agent`](suspicious_user_agent.nwr/)** | Logs, Network | Identifies suspicious user-agent strings. |
| **[`Device: Android`](device_android.nwr/)** | Logs, Network | Tags Android devices based on user-agent value. |
| **[`Device: ChromeOS`](device_chromeos.nwr/)** | Logs, Network | Tags ChromeOS devices based on user-agent value. |
| **[`Device: iPad`](device_ipad.nwr/)** | Logs, Network | Tags iPad devices based on user-agent value. |
| **[`Device: iPhone`](device_iphone.nwr/)** | Logs, Network | Tags iPhone devices based on user-agent value. |
| **[`Device: Linux`](device_linux.nwr/)** | Logs, Network | Tags Linux devices based on user-agent value. |
| **[`Device: Mac`](device_mac.nwr/)** | Logs, Network | Tags Mac devices based on user-agent value. |
| **[`Device: Windows`](device_windows.nwr/)** | Logs, Network | Tags Windows devices based on user-agent value. |
